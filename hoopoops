# Importing Packages
import sys

import pygame.freetype
from pygame import mixer

#Start Screen
from tkinter import messagebox
start = messagebox.askokcancel(title="Hoo's Pooping?", message="Welcome to Hoo's Pooping? As you go around Grounds, mark your bowel movements. Use the arrow keys to navigate the map. Press space to mark your poops! Press OK to continue or CANCEL to quit.")
if start == False:
    sys.exit()


# Global Variables
clock = pygame.time.Clock()
screenWidth = 920
screenHeight = 580
size = 920, 580
timer = None
fps = 120
pygame.display.set_caption('HOOSPOOPING?????')
x, y = 200, 130
black = (0, 0, 0)
white = (255, 255, 255)
green = (0, 255, 0)
red = (255, 0, 0)
bright_red = (255, 0, 0)
bright_green = (0, 255, 0)
count = 0

# Load Graphics
imgGrass = pygame.image.load("venv/content/Graphics/grass.png")
imgGrass = pygame.transform.scale(imgGrass, (920, 580))
imgPoop = pygame.image.load("venv/content/Graphics/poop.png")
imgPoop = pygame.transform.scale(imgPoop, (50, 50))

# Initialization Function
pygame.init()
screen = pygame.display.set_mode((size))
pygame.display.set_caption("HoosPooping??")
mixer.init()
mixer.music.load("venv/content/music/8_bit_fun.mp3")
mixer.music.set_volume(0.2)
mixer.music.play(-1)

# Fart Sound Effect
fartSound = pygame.mixer.Sound("venv/content/music/fart.wav")
flushSound = pygame.mixer.Sound("venv/content/music/flush.wav")

# Bowel (Sprite) Movement Mechanics
sprite = imgPoop
loop = True
poops = []

while loop:
    screen.fill((0, 0, 0))
    screen.blit(imgGrass, (0, 0))
    # this adds the sprite at every frame rate

    i = 0
    while i < len(poops):
        screen.blit(sprite, (poops[i], poops[i+1]))
        i = i + 2

    screen.blit(sprite, (x, y))

    # Key inputs, with boundaries
    keys = pygame.key.get_pressed()
    if keys[pygame.K_LEFT] and x > 2:
        # Making sure the top left position of our character is greater than our vel so we never move off the screen.
        x -= 5
    if keys[pygame.K_RIGHT] and x < 870:
        # Making sure the top right corner of our character is less than the screen width - its width
        x += 5
    if keys[pygame.K_UP] and y > 2:  # Same principles apply for the y coordinate
        y -= 5
    if keys[pygame.K_DOWN] and y < 530:
        y += 5
    # Dropping a Poop
    if keys[pygame.K_SPACE] and not (725 < x < 920 and 500 < y < 580):
        poops.append(x)
        poops.append(y)
        fartSound.play()
        count += 1
        pygame.time.delay(100)
    # Done Pooping
    pygame.time.delay(0)
    if keys[pygame.K_SPACE] and 725 < x < 920 and 500 < y < 580:
        flushSound.play()
        start = messagebox.askokcancel(title="Done Pooping?", message= "Now that you are done pooping, please wipe and flush. You have pooped " + str(count) + " time(s). Stinky, stinky!")
        if start == False:
            sys.exit()
        else:
            sys.exit()

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            loop = False
    # we update the screen at every frame
    pygame.display.flip()
    # if we put the frame rate at 60 the sprite will move slower
    clock.tick(120)

    # Draw graphics

 # window.fill(bgColor)

 # window.blit(imgGrass, (0, 0))  # draw at (0,0)
 # window.blit(imgPoop, (0, 0))  # draw at (0,0)

    # Update screen
    pygame.display.flip()
    clock.tick(fps)

